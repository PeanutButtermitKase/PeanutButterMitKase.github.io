<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mozilla Hubs BitECS Example</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://unpkg.com/bitecs@1.0.0/dist/bitecs.min.js"></script>
</head>
<body>
    <a-scene>
        <a-entity id="cube" geometry="primitive: box" material="color: #4CC3D9" position="0 1.6 -5"></a-entity>

        <a-entity camera look-controls wasd-controls position="0 1.6 0"></a-entity>
    </a-scene>

    <script>
        // Import BitECS and create a new world
        const { createWorld, Types, Not } = window.bitecs;
        const world = createWorld();

        // Define components
        const Position = Types.i16;
        const Rotation = Types.i16;

        // Create an entity with components
        const entity = world.createEntity();
        world.addComponent(entity, Position);
        world.addComponent(entity, Rotation);

        // Set initial values for components
        world.setComponent(entity, Position, 0, 1.6, -5);
        world.setComponent(entity, Rotation, 0, 0, 0);

        // Update function to be called each frame
        function update() {
            // Access components and update the A-Frame entity
            const position = world.getComponent(entity, Position);
            const rotation = world.getComponent(entity, Rotation);

            const cube = document.getElementById('cube');
            cube.setAttribute('position', `${position[0]} ${position[1]} ${position[2]}`);
            cube.setAttribute('rotation', `${rotation[0]} ${rotation[1]} ${rotation[2]}`);
        }

        // Register the update function to be called each frame
        AFRAME.registerComponent('bitECS-update', {
            tick: function () {
                update();
            }
        });
    </script>
</body>
</html>
